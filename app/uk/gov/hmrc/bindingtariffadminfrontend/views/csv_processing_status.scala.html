@*
 * Copyright 2020 HM Revenue & Customs
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *@

@import uk.gov.hmrc.bindingtariffadminfrontend.config.AppConfig
@import uk.gov.hmrc.bindingtariffadminfrontend.controllers.routes
@import uk.gov.hmrc.bindingtariffadminfrontend.views.html.govuk_wrapper
@()(implicit request: Request[_], messages: Messages, appConfig: AppConfig)

@main_template(title = "Binding Tariff Admin", bodyClasses = None) {

<a href="@routes.IndexController.get()" class="link-back">Back to Index</a>

<h1 class="heading-xlarge">Data files processing status</h1>

<div id="processing-status-container" class="mt-30">

 <h3 class="heading-medium">Status</h3>

 <table id="success-table">
  <tr>
   <td></td>
   <td></td>
   <td></td>
  </tr>
  <tr>
  <tr>
   <td>BTI Processing status</td>
   <td><span class="processing" id="bti-processing-status">Initiated</span></td>
   <td class="align-right"><button id="data_migration_bti_processing_status" class="button button-info" disabled="disabled">Download json</button></td>
  </tr>
  <tr>
  <tr>
   <td>Liabilities Processing status</td>
   <td><span class="processing" id="liabilities-processing-status">Initiated</span></td>
   <td class="align-right"><button id="data_migration_liabilities_processing_status" class="button button-info" disabled="disabled">Download json</button></td>
 </tr>
  <tr>
   <td>Correspondence Processing status</td>
   <td><span class="processing" id="correspondence-processing-status">Initiated</span></td>
   <td class="align-right"><button id="data_migration_correspondence_processing_status" class="button button-info" disabled="disabled">Download json</button></td>
  </tr>
  <tr>
   <td>Miscellaneous Processing status</td>
   <td><span class="processing" id="miscellaneous-processing-status">Initiated</span></td>
   <td class="align-right"><button id="data_migration_miscellaneous_processing_status" class="button button-info" disabled="disabled">Download json</button></td>
  </tr>
 </table>
</div>

<div id="summary-container" class="mt-30" aria-hidden="true" hidden="true">

 <div class="grid-row">
  <div class="column-one-half">
   <h3 class="heading-medium">Volumetrics</h3>
  </div>
  <div class="column-one-half align-right">
   <button id="data_migration_migration-reports" class="button button-info mt-30" disabled="disabled">Download reports</button>
  </div>
 </div>

 <table id="summary-table">
  <tr>
   <td></td>
   <td></td>
  </tr>
  <tr id="migrated-bti-row">
   <td>BTIs migrated</td>
   <td class="align-right"><span class="processing" id="migrated-bti-count">0</span></td>
  </tr>
  <tr id="migrated-liability-row">
   <td>Liabilities migrated</td>
   <td class="align-right"><span class="processing" id="migrated-liability-count">0</span></td>
  </tr>
  <tr id="migrated-correspondence-row">
   <td>Correspondence migrated</td>
   <td class="align-right"><span class="processing" id="migrated-correspondence-count">0</span></td>
  </tr>
  <tr id="migrated-miscellaneous-row">
   <td>Miscellaneous migrated</td>
   <td class="align-right"><span class="processing" id="migrated-miscellaneous-count">0</span></td>
  </tr>
  <tr id="discarded-bti-row">
   <td><span class="error-message">BTIs discarded</span></td>
   <td class="align-right"><span class="processing error-message" id="discarded-bti-count">0</span></td>
  </tr>
  <tr id="discarded-liability-row">
   <td><span class="error-message">Liabilities discarded</span></td>
   <td class="align-right"><span class="processing error-message" id="discarded-liability-count">0</span></td>
  </tr>
  <tr id="discarded-correspondence-row">
   <td><span class="error-message">Correspondence discarded</span></td>
   <td class="align-right"><span class="processing error-message" id="discarded-correspondence-count">0</span></td>
  </tr>
  <tr id="discarded-miscellaneous-row">
   <td><span class="error-message">Miscellaneous discarded</span></td>
   <td class="align-right"><span class="processing error-message" id="discarded-miscellaneous-count">0</span></td>
  </tr>
  <tr id="error-row" aria-hidden="true" hidden="true">
   <td><span class="error-message">Error count</span></td>
   <td class="align-right"><span class="processing error-message" id="error-count">0</span></td>
  </tr>
 </table>
</div>

<div id="error-container" class="mt-30" aria-hidden="true" hidden="true">

 <h3 class="heading-small">Errors</h3>

 <ul id="error-list">
 </ul>
</div>

<div id="bti-discarded-container" class="mt-30" aria-hidden="true" hidden="true">

 <h3 class="heading-small">Discarded BTI Reasons</h3>

 <table id="bti-discarded-reasons-table">
  <tr>
   <td></td>
   <td></td>
  </tr>
  <tr id="discarded-bti-historic-case-row" aria-hidden="true" hidden="true">
   <td class="font-xsmall">Historic case</td>
   <td class="align-right"><span class="font-xsmall processing" id="discarded-bti-historic-case-count"></span></td>
  </tr>
  <tr id="rejected-bti-row" aria-hidden="true" hidden="true">
   <td class="font-xsmall">Rejected case status</td>
   <td class="align-right"><span class="font-xsmall processing" id="rejected-bti-count"></span></td>
  </tr>
  <tr id="suppressed-bti-row" aria-hidden="true" hidden="true">
   <td class="font-xsmall">Suppressed case status</td>
   <td class="align-right"><span class="font-xsmall processing" id="suppressed-bti-count"></span></td>
  </tr>
  <tr id="bti-no-application-record-row" aria-hidden="true" hidden="true">
   <td class="font-xsmall">Missing eBTI_Application record</td>
   <td class="align-right"><span class="font-xsmall processing" id="bti-no-application-record-count"></span></td>
  </tr>
  <tr id="bti-no-case-bti-record-row" aria-hidden="true" hidden="true">
   <td class="font-xsmall">Missing tblCaseBTI record</td>
   <td class="align-right"><span class="font-xsmall processing" id="bti-no-case-bti-record-count"></span></td>
  </tr>
  <tr id="bti-no-class-meth-record-row" aria-hidden="true" hidden="true">
   <td class="font-xsmall">Missing tblCaseClassMeth record</td>
   <td class="align-right"><span class="font-xsmall processing" id="bti-no-class-meth-record-count"></span></td>
  </tr>
  <tr id="bti-no-address-records-row" aria-hidden="true" hidden="true">
   <td class="font-xsmall">Missing eBTI_Addresses records</td>
   <td class="align-right"><span class="font-xsmall processing" id="bti-no-address-records-count"></span></td>
  </tr>
 </table>
</div>

<div id="liability-discarded-container" class="mt-30" aria-hidden="true" hidden="true">

 <h3 class="heading-small">Discarded Liability Reasons</h3>

 <table id="liability-discarded-reasons-table">
  <tr>
   <td></td>
   <td></td>
  </tr>
  <tr id="discarded-liability-historic-case-row" aria-hidden="true" hidden="true">
   <td class="font-xsmall">Historic case</td>
   <td class="align-right"><span class="font-xsmall processing" id="discarded-liability-historic-case-count"></span></td>
  </tr>
  <tr id="rejected-liability-row" aria-hidden="true" hidden="true">
   <td class="font-xsmall">Rejected case status</td>
   <td class="align-right"><span class="font-xsmall processing" id="rejected-liability-count"></span></td>
  </tr>
  <tr id="suppressed-liability-row" aria-hidden="true" hidden="true">
   <td class="font-xsmall">Suppressed case status</td>
   <td class="align-right"><span class="font-xsmall processing" id="suppressed-liability-count"></span></td>
  </tr>
  <tr id="liability-no-class-meth-record-row" aria-hidden="true" hidden="true">
   <td class="font-xsmall">Missing tblCaseClassMeth record</td>
   <td class="align-right"><span class="font-xsmall processing" id="liability-no-class-meth-record-count"></span></td>
  </tr>
 </table>
</div>

<div id="correspondence-discarded-container" class="mt-30" aria-hidden="true" hidden="true">

 <h3 class="heading-small">Discarded Correspondence Reasons</h3>

 <table id="correspondence-discarded-reasons-table">
  <tr>
   <td></td>
   <td></td>
  </tr>
  <tr id="discarded-correspondence-not-implemented-row" aria-hidden="true" hidden="true">
   <td class="font-xsmall">Not implemented</td>
   <td class="align-right"><span class="font-xsmall processing" id="discarded-correspondence-not-implemented-count"></span></td>
  </tr>
 </table>
</div>

<div id="miscellaneous-discarded-container" class="mt-30" aria-hidden="true" hidden="true">

 <h3 class="heading-small">Discarded Miscellaneous Reasons</h3>

 <table id="miscellaneous-discarded-reasons-table">
  <tr>
   <td></td>
   <td></td>
  </tr>
  <tr id="discarded-miscellaneous-not-implemented-row" aria-hidden="true" hidden="true">
   <td class="font-xsmall">Not implemented</td>
   <td class="align-right"><span class="font-xsmall processing" id="discarded-miscellaneous-not-implemented-count"></span></td>
  </tr>
 </table>
</div>

<div id="detailed-bti-discarded-cases-container" class="mt-30" aria-hidden="true" hidden="true">

 <h3 class="heading-small">Discarded BTI Case Numbers</h3>

 <div id="discarded-bti-historic-case-details" aria-hidden="true" hidden="true">
  <details>
   <summary><span class="summary">BTI - Historic case</span></summary>
   <div class="panel panel-border-narrow">
    <ul id="discarded-bti-historic-case-list">
    </ul>
   </div>
  </details>
 </div>

 <div id="rejected-bti-details" aria-hidden="true" hidden="true">
  <details>
   <summary><span class="summary">BTI - Rejected case status</span></summary>
   <div class="panel panel-border-narrow">
    <ul id="rejected-bti-list">
    </ul>
   </div>
  </details>
 </div>

 <div id="suppressed-bti-details" aria-hidden="true" hidden="true">
  <details>
   <summary><span class="summary">BTI - Suppressed case status</span></summary>
   <div class="panel panel-border-narrow">
    <ul id="suppressed-bti-list">
    </ul>
   </div>
  </details>
 </div>

 <div id="bti-no-application-record-details" aria-hidden="true" hidden="true">
  <details>
   <summary><span class="summary">BTI - Missing eBTI_Application record</span></summary>
   <div class="panel panel-border-narrow">
    <ul id="bti-no-application-record-list">
    </ul>
   </div>
  </details>
 </div>

 <div id="bti-no-case-bti-record-details" aria-hidden="true" hidden="true">
  <details>
   <summary><span class="summary">BTI - Missing tblCaseBTI record</span></summary>
   <div class="panel panel-border-narrow">
    <ul id="bti-no-case-bti-record-list">
    </ul>
   </div>
  </details>
 </div>

 <div id="bti-no-class-meth-record-details" aria-hidden="true" hidden="true">
  <details>
   <summary><span class="summary">BTI - Missing tblCaseClassMeth record</span></summary>
   <div class="panel panel-border-narrow">
    <ul id="bti-no-class-meth-record-list">
    </ul>
   </div>
  </details>
 </div>

 <div id="bti-no-address-records-details" aria-hidden="true" hidden="true">
  <details>
   <summary><span class="summary">BTI - Missing eBTI_Addresses records</span></summary>
   <div class="panel panel-border-narrow">
    <ul id="bti-no-address-records-list">
    </ul>
   </div>
  </details>
 </div>
</div>

<div id="detailed-liability-discarded-cases-container" class="mt-30" aria-hidden="true" hidden="true">

 <h3 class="heading-small">Discarded Liability Case Numbers</h3>

 <div id="discarded-liability-historic-case-details" aria-hidden="true" hidden="true">
  <details>
   <summary><span class="summary">Liability - Historic case</span></summary>
   <div class="panel panel-border-narrow">
    <ul id="discarded-liability-historic-case-list">
    </ul>
   </div>
  </details>
 </div>

 <div id="rejected-liability-details" aria-hidden="true" hidden="true">
  <details>
   <summary><span class="summary">Liability - Rejected case status</span></summary>
   <div class="panel panel-border-narrow">
    <ul id="rejected-liability-list">
    </ul>
   </div>
  </details>
 </div>

 <div id="suppressed-liability-details" aria-hidden="true" hidden="true">
  <details>
   <summary><span class="summary">Liability - Suppressed case status</span></summary>
   <div class="panel panel-border-narrow">
    <ul id="suppressed-liability-list">
    </ul>
   </div>
  </details>
 </div>

 <div id="liability-no-class-meth-record-details" aria-hidden="true" hidden="true">
  <details>
   <summary><span class="summary">Liability - Missing tblCaseClassMeth record</span></summary>
   <div class="panel panel-border-narrow">
    <ul id="liability-no-class-meth-record-list">
    </ul>
   </div>
  </details>
 </div>
</div>

<div id="detailed-correspondence-discarded-cases-container" class="mt-30" aria-hidden="true" hidden="true">

 <h3 class="heading-small">Discarded Correspondence Case Numbers</h3>

 <div id="discarded-correspondence-not-implemented-details" aria-hidden="true" hidden="true">
  <details>
   <summary><span class="summary">Correspondence - Not implemented</span></summary>
   <div class="panel panel-border-narrow">
    <ul id="discarded-correspondence-not-implemented-list">
    </ul>
   </div>
  </details>
 </div>
</div>

<div id="detailed-miscellaneous-discarded-cases-container" class="mt-30" aria-hidden="true" hidden="true">

 <h3 class="heading-small">Discarded Miscellaneous Case Numbers</h3>

 <div id="discarded-miscellaneous-not-implemented-details" aria-hidden="true" hidden="true">
  <details>
   <summary><span class="summary">Miscellaneous - Not implemented</span></summary>
   <div class="panel panel-border-narrow">
    <ul id="discarded-miscellaneous-not-implemented-list">
    </ul>
   </div>
  </details>
 </div>
</div>

<script src="@controllers.routes.Assets.at("javascripts/data-processing.js")" type="text/javascript"></script>
<script type="text/javascript">
 function fetchData(){
   var status = document.getElementById("bti-processing-status");
   if(status.innerHTML !== "done" && status.innerHTML !== "failed"){
     dataProcessing.updateStatus("@routes.DataMigrationJsonController.getStatusOfJsonProcessing.url")
   }
 }
 document.addEventListener("DOMContentLoaded", function(event) {
   fetchData();
   setInterval(fetchData,5000);
 });
 document.getElementById("data_migration_bti_processing_status").addEventListener("click", function(event) {
    var link = document.createElement("a");
    link.href = "@routes.DataMigrationJsonController.downloadBTIJson().url";
    link.click();
 });
 document.getElementById("data_migration_liabilities_processing_status").addEventListener("click", function(event) {
    var link = document.createElement("a");
    link.href = "@routes.DataMigrationJsonController.downloadLiabilitiesJson().url";
    link.click();
 });
 document.getElementById("data_migration_correspondence_processing_status").addEventListener("click", function(event) {
    var link = document.createElement("a");
    link.href = "@routes.DataMigrationJsonController.downloadCorrespondenceJson().url";
    link.click();
 });
 document.getElementById("data_migration_miscellaneous_processing_status").addEventListener("click", function(event) {
    var link = document.createElement("a");
    link.href = "@routes.DataMigrationJsonController.downloadMiscellaneousJson().url";
    link.click();
 });
 document.getElementById("data_migration_migration-reports").addEventListener("click", function(event) {
    var link = document.createElement("a");
    link.href = "@routes.DataMigrationJsonController.downloadMigrationReports().url";
    link.click();
 });
</script>

}
